<template name="message">
  <li>
    {{#if avatar}}
      <img src="{{avatar}}" class="user-avatar">
    {{/if}}
    <div class="message-body {{#unless isNewAuthor}}no-avatar{{/unless}}">
      {{#if isNewAuthor}}
      <div>
        <span class="username">{{user.username}}</span>
        <span class="time">{{time timestamp}}</span>
      </div>
      {{/if}}
      {{#if isEditing.get}}
        {{> messageEditBox}}
      {{else}}
        {{#if isOwner}}
          <a href="#" class="edit">Edit</a>
        {{/if}}
        <div class="message">{{#emojione}}{{#markdown}}{{#linkify}}{{message}}{{/linkify}}{{/markdown}}{{/emojione}}
          {{#if messageUrls}}
            {{#each messageUrls}}
              {{> oembed url=this}}
            {{/each}}
          {{/if}}
        </div>
      {{/if}}
    </div>
  </li>
</template>

<template name="messageEditBox">
  <div class="edit-box">
    <textarea cols="90" class="form-message-input">{{_removeTrailingNewLine message}}</textarea>
  </div>
</template>
